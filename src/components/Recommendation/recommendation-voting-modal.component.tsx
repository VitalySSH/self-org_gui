import { Modal } from 'antd';
import { useEffect, useState } from 'react';
import { RecommendationModalProps } from 'src/interfaces';
import './recommendation-voting-modal.component.scss';

export const RecommendationVotingModal = ({
                                            open,
                                            onCancel,
                                          }: RecommendationModalProps) => {
  const [isMobile, setIsMobile] = useState(false);

  // Определение мобильного устройства
  useEffect(() => {
    const checkMobile = () => {
      setIsMobile(window.innerWidth <= 768);
    };

    checkMobile();
    window.addEventListener('resize', checkMobile);
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  return (
    <Modal
      title="Рекомендации по настройке голосований"
      open={open}
      onCancel={onCancel}
      footer={null}
      styles={{
        body: {
          maxHeight: isMobile ? 'calc(100vh - 120px)' : 'calc(100vh - 200px)',
          overflowY: 'auto',
          padding: isMobile ? '12px 16px' : '16px 24px',
        },
        content: {
          maxHeight: isMobile ? '100vh' : 'calc(100vh - 40px)',
          display: 'flex',
          flexDirection: 'column',
        },
      }}
      width={isMobile ? "100%" : "60%"}
      className="recommendation-modal"
      centered={!isMobile}
      destroyOnClose
      maskClosable
      keyboard
      // Мобильные настройки
      {...(isMobile && {
        style: {
          top: 0,
          paddingBottom: 0,
          margin: 0,
        },
        styles: {
          ...{
            body: {
              maxHeight: 'calc(100vh - 120px)',
              overflowY: 'auto',
              padding: '12px 16px',
            },
            content: {
              height: '100vh',
              maxHeight: '100vh',
              display: 'flex',
              flexDirection: 'column',
              borderRadius: 0,
            },
          },
        },
      })}
    >
      <div className="voting-settings-guide">
        <h2 className="guide-title">Философия настройки голосований</h2>

        <div className="guide-section">
          <p>
            Коллективное принятие решений — это постоянный поиск баланса между
            скоростью и качеством, между единством и разнообразием мнений.
            Оптимальные параметры голосования невозможно установить раз и
            навсегда — они должны эволюционировать вместе с вашим сообществом.
          </p>
        </div>

        <div className="guide-section">
          <h3 className="param-title">Кворум: порог участия</h3>
          <p>
            Устанавливая <strong>низкий кворум (20-30%)</strong>, вы позволяете
            сообществу быстро реагировать на изменения. Решения принимаются
            оперативно, но есть риск, что они будут отражать мнение лишь
            активного меньшинства. Со временем это может привести к апатии
            остальных участников, которые почувствуют, что их голос не
            востребован.
          </p>
          <p>
            <strong>Высокий кворум (70-90%)</strong> гарантирует, что решение
            поддержано большинством, но создает парадокс — самые важные вопросы
            могут годами ждать своего рассмотрения, пока не наберётся
            достаточное количество голосов. Это особенно критично для сообществ,
            где участники редко бывают онлайн одновременно.
          </p>
        </div>

        <div className="guide-transition">
          <p>
            Определив оптимальный уровень участия, стоит задуматься — какое
            единство мнений действительно необходимо для принятия решения?
          </p>
        </div>

        <div className="guide-section">
          <h3 className="param-title">Избирательный порог: мера согласия</h3>
          <p>
            <strong>Либеральный порог (50-60%)</strong> позволяет оперативно
            реализовывать инициативы, но будьте готовы к тому, что почти
            половина сообщества может остаться недовольной. В динамично
            развивающихся сообществах это иногда оправдано — лучше быстро
            принять неидеальное решение, чем упустить возможность.
          </p>
          <p>
            <strong>Консервативный порог (75-90%)</strong> требует поиска
            решений, устраивающих практически всех. Такой подход резко снижает
            количество "обратных переголосований", но может привести к параличу,
            когда небольшие, но активные группы блокируют любые изменения,
            просто сохраняя статус-кво.
          </p>
        </div>

        <div className="guide-transition">
          <p>
            Когда основные позиции определены, наступает время позаботиться о
            тех, чьё мнение не стало частью большинства...
          </p>
        </div>

        <div className="guide-section">
          <h3 className="param-title">
            Значимое меньшинство: голос несогласных
          </h3>
          <p>
            <strong>Низкий порог (5-10%)</strong> заставляет учитывать даже
            небольшие группы несогласных. Это ценно для инноваций — часто именно
            маргинальные идеи впоследствии оказываются прорывными. Однако
            постоянные уступки меньшинствам могут размывать ответственность и
            создавать "комитет по бесконечным согласованиям".
          </p>
          <p>
            <strong>Высокий порог (30-40%)</strong> фокусирует внимание на
            существенных разногласиях. Такой подход укрепляет стабильность, но
            может привести к "тирании большинства", когда систематически
            игнорируются потребности постоянных меньшинств (например, удалённых
            сотрудников или представителей редких специализаций).
          </p>
        </div>

        <div className="guide-section">
          <h3 className="conclusion-title">Динамическая настройка</h3>
          <p>
            Начинайте с умеренных значений (кворум 40%, порог 65%, меньшинство
            20%) и наблюдайте за поведением системы. Замечаете частые отмены
            решений — изменяйте пороги. Видите падение активности — снижайте
            кворум. Главное — помнить, что эти параметры не просто технические
            настройки, а инструменты формирования культуры вашего сообщества.
          </p>
          <div className="warning-note">
            <strong>⚠️ Важно:</strong> Любые изменения мгновенно влияют на все текущие голосования.
            Особенно осторожно меняйте параметры в процессе важных обсуждений!
          </div>
        </div>
      </div>
    </Modal>
  );
};